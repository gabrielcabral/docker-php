var ZeroClipboard={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(b){if(typeof b=="string"){b=document.getElementById(b)}if(!b.addClass){b.hide=function(){this.style.display="none"};b.show=function(){this.style.display=""};b.addClass=function(a){this.removeClass(a);this.className+=" "+a};b.removeClass=function(a){this.className=this.className.replace(new RegExp("\\s*"+a+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")};b.hasClass=function(a){return !!this.className.match(new RegExp("\\s*"+a+"\\s*"))}}return b},setMoviePath:function(b){this.moviePath=b},dispatch:function(e,d,f){(e=this.clients[e])&&e.receiveEvent(d,f)},register:function(d,c){this.clients[d]=c},getDOMObjectPosition:function(d){var c={left:0,top:0,width:d.width?d.width:d.offsetWidth,height:d.height?d.height:d.offsetHeight};if(d.style.width!=""){c.width=d.style.width.replace("px","")}if(d.style.height!=""){c.height=d.style.height.replace("px","")}for(;d;){c.left+=d.offsetLeft;c.top+=d.offsetTop;d=d.offsetParent}return c},Client:function(b){this.handlers={};this.id=ZeroClipboard.nextId++;this.movieId="ZeroClipboardMovie_"+this.id;ZeroClipboard.register(this.id,this);b&&this.glue(b)}};ZeroClipboard.Client.prototype={id:0,ready:false,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:true,cssEffects:true,handlers:null,sized:false,glue:function(f,e){this.domElement=ZeroClipboard.$(f);f=99;if(this.domElement.style.zIndex){f=parseInt(this.domElement.style.zIndex)+1}var h=ZeroClipboard.getDOMObjectPosition(this.domElement);this.div=document.createElement("div");var g=this.div.style;g.position="absolute";g.left=this.domElement.offsetLeft+"px";g.top=this.domElement.offsetTop+"px";g.width=h.width+"px";g.height=h.height+"px";g.zIndex=f;if(typeof e!="undefined"&&e!=""){this.div.title=e}if(h.width!=0&&h.height!=0){this.sized=true}this.domElement.parentNode.appendChild(this.div);this.div.innerHTML=this.getHTML(h.width,h.height)},positionElement:function(){var d=ZeroClipboard.getDOMObjectPosition(this.domElement),c=this.div.style;c.position="absolute";c.left=this.domElement.offsetLeft+"px";c.top=this.domElement.offsetTop+"px";c.width=d.width+"px";c.height=d.height+"px";if(d.width!=0&&d.height!=0){this.sized=true}c=this.div.childNodes[0];c.width=d.width;c.height=d.height},getHTML:function(g,e){var k="",j="id="+this.id+"&width="+g+"&height="+e;if(navigator.userAgent.match(/MSIE/)){var h=location.href.match(/^https/i)?"https://":"http://";k+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+h+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+g+'" height="'+e+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+j+'"/><param name="wmode" value="transparent"/></object>'}else{k+='<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+g+'" height="'+e+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+j+'" wmode="transparent" />'}return k},hide:function(){if(this.div){this.div.style.left="-2000px"}},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide();this.div.innerHTML="";var d=document.getElementsByTagName("body")[0];try{d.removeChild(this.div)}catch(c){}this.div=this.domElement=null}},reposition:function(d){if(d){(this.domElement=ZeroClipboard.$(d))||this.hide()}if(this.domElement&&this.div){d=ZeroClipboard.getDOMObjectPosition(this.domElement);var c=this.div.style;c.left=""+d.left+"px";c.top=""+d.top+"px"}},clearText:function(){this.clipText="";this.ready&&this.movie.clearText()},appendText:function(b){this.clipText+=b;this.ready&&this.movie.appendText(b)},setText:function(b){this.clipText=b;this.ready&&this.movie.setText(b)},setCharSet:function(b){this.charSet=b;this.ready&&this.movie.setCharSet(b)},setBomInc:function(b){this.incBom=b;this.ready&&this.movie.setBomInc(b)},setFileName:function(b){this.fileName=b;this.ready&&this.movie.setFileName(b)},setAction:function(b){this.action=b;this.ready&&this.movie.setAction(b)},addEventListener:function(d,c){d=d.toString().toLowerCase().replace(/^on/,"");this.handlers[d]||(this.handlers[d]=[]);this.handlers[d].push(c)},setHandCursor:function(b){this.handCursorEnabled=b;this.ready&&this.movie.setHandCursor(b)},setCSSEffects:function(b){this.cssEffects=!!b},receiveEvent:function(h,g){h=h.toString().toLowerCase().replace(/^on/,"");switch(h){case"load":this.movie=document.getElementById(this.movieId);if(!this.movie){var m=this;setTimeout(function(){m.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){m=this;setTimeout(function(){m.receiveEvent("load",null)},100);this.ready=true;return}this.ready=true;this.movie.clearText();this.movie.appendText(this.clipText);this.movie.setFileName(this.fileName);this.movie.setAction(this.action);this.movie.setCharSet(this.charSet);this.movie.setBomInc(this.incBom);this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":if(this.domElement&&this.cssEffects){this.recoverActive=false;if(this.domElement.hasClass("active")){this.domElement.removeClass("active");this.recoverActive=true}}break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":if(this.domElement&&this.cssEffects){this.domElement.removeClass("active");this.recoverActive=false}break}if(this.handlers[h]){for(var l=0,j=this.handlers[h].length;l<j;l++){var k=this.handlers[h][l];if(typeof k=="function"){k(this,g)}else{if(typeof k=="object"&&k.length==2){k[0][k[1]](this,g)}else{typeof k=="string"&&window[k](this,g)}}}}}};var TableTools;(function(b,c,a){TableTools=function(e,d){if(!this.CLASS||this.CLASS!="TableTools"){alert("Warning: TableTools must be initialised with the keyword 'new'")}this.s={that:this,dt:null,print:{saveStart:-1,saveLength:-1,saveScroll:-1,funcEnd:function(){}},buttonCounter:0,select:{type:"",selected:[],preRowSelect:null,postSelected:null,postDeselected:null,all:false,selectedClass:""},custom:{},swfPath:"",buttonSet:[],master:false};this.dom={container:null,table:null,print:{hidden:[],message:null},collection:{collection:null,background:null}};this.fnSettings=function(){return this.s};if(typeof d=="undefined"){d={}}this.s.dt=e.fnSettings();this._fnConstruct(d);return this};TableTools.prototype={fnGetSelected:function(){return this._fnGetMasterSettings().select.selected},fnIsSelected:function(f){for(var e=this.fnGetSelected(),h=0,g=e.length;h<g;h++){if(f==e[h]){return true}}return false},fnSelectAll:function(){this._fnGetMasterSettings().that._fnRowSelectAll()},fnSelectNone:function(){this._fnGetMasterSettings().that._fnRowDeselectAll()},fnGetTitle:function(e){var d="";if(typeof e.sTitle!="undefined"&&e.sTitle!==""){d=e.sTitle}else{e=a.getElementsByTagName("title");if(e.length>0){d=e[0].innerHTML}}return"\u00a1".toString().length<4?d.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""):d.replace(/[^a-zA-Z0-9_\.,\-_ !\(\)]/g,"")},fnCalcColRatios:function(j){var e=this.s.dt.aoColumns;j=this._fnColumnTargets(j.mColumns);var o=[],n=0,m=0,k,l;k=0;for(l=j.length;k<l;k++){if(j[k]){n=e[k].nTh.offsetWidth;m+=n;o.push(n)}}k=0;for(l=o.length;k<l;k++){o[k]/=m}return o.join("\t")},fnGetTableData:function(d){if(this.s.dt){return this._fnGetDataTablesData(d)}},fnSetText:function(e,d){this._fnFlashSetText(e,d)},fnResizeButtons:function(){for(var e in ZeroClipboard.clients){if(e){var d=ZeroClipboard.clients[e];typeof d.domElement!="undefined"&&d.domElement.parentNode==this.dom.container&&d.positionElement()}}},fnResizeRequired:function(){for(var e in ZeroClipboard.clients){if(e){var d=ZeroClipboard.clients[e];if(typeof d.domElement!="undefined"&&d.domElement.parentNode==this.dom.container&&d.sized===false){return true}}}return false},_fnConstruct:function(d){this._fnCustomiseSettings(d);this.dom.container=a.createElement("div");this.dom.container.style.position="relative";this.dom.container.className=!this.s.dt.bJUI?"DTTT_container":"DTTT_container ui-buttonset ui-buttonset-multi";this.s.select.type!="none"&&this._fnRowSelectConfig();this._fnButtonDefinations(this.s.buttonSet,this.dom.container)},_fnCustomiseSettings:function(d){if(typeof this.s.dt._TableToolsInit=="undefined"){this.s.master=true;this.s.dt._TableToolsInit=true}this.dom.table=this.s.dt.nTable;this.s.custom=b.extend({},TableTools.DEFAULTS,d);this.s.swfPath=this.s.custom.sSwfPath;if(typeof ZeroClipboard!="undefined"){ZeroClipboard.moviePath=this.s.swfPath}this.s.select.type=this.s.custom.sRowSelect;this.s.select.preRowSelect=this.s.custom.fnPreRowSelect;this.s.select.postSelected=this.s.custom.fnRowSelected;this.s.select.postDeselected=this.s.custom.fnRowDeselected;this.s.select.selectedClass=this.s.custom.sSelectedClass;this.s.buttonSet=this.s.custom.aButtons},_fnButtonDefinations:function(g,e){for(var k,j=0,h=g.length;j<h;j++){if(typeof g[j]=="string"){if(typeof TableTools.BUTTONS[g[j]]=="undefined"){alert("TableTools: Warning - unknown button type: "+g[j]);continue}k=b.extend({},TableTools.BUTTONS[g[j]],true)}else{if(typeof TableTools.BUTTONS[g[j].sExtends]=="undefined"){alert("TableTools: Warning - unknown button type: "+g[j].sExtends);continue}k=b.extend({},TableTools.BUTTONS[g[j].sExtends],true);k=b.extend(k,g[j],true)}if(this.s.dt.bJUI){k.sButtonClass+=" ui-button ui-state-default";k.sButtonClassHover+=" ui-button ui-state-default ui-state-hover"}e.appendChild(this._fnCreateButton(k))}},_fnCreateButton:function(e){var d=this._fnButtonBase(e);if(e.sAction=="print"){this._fnPrintConfig(d,e)}else{if(e.sAction.match(/flash/)){this._fnFlashConfig(d,e)}else{if(e.sAction=="text"){this._fnTextConfig(d,e)}else{if(e.sAction=="collection"){this._fnTextConfig(d,e);this._fnCollectionConfig(d,e)}}}}return d},_fnButtonBase:function(f){var e=a.createElement("button"),h=a.createElement("span"),g=this._fnGetMasterSettings();e.className="DTTT_button "+f.sButtonClass;e.setAttribute("id","ToolTables_"+this.s.dt.sInstance+"_"+g.buttonCounter);e.appendChild(h);h.innerHTML=f.sButtonText;g.buttonCounter++;return e},_fnGetMasterSettings:function(){if(this.s.master){return this.s}else{for(var e=TableTools._aInstances,d=0,f=e.length;d<f;d++){if(this.dom.table==e[d].s.dt.nTable){return e[d].s}}}},_fnCollectionConfig:function(e,d){e=a.createElement("div");e.style.display="none";e.className=!this.s.dt.bJUI?"DTTT_collection":"DTTT_collection ui-buttonset ui-buttonset-multi";d._collection=e;this._fnButtonDefinations(d.aButtons,e)},_fnCollectionShow:function(u,t){var s=this,r=b(u).offset(),q=t._collection;t=r.left;r=r.top+b(u).outerHeight();var o=b(c).height(),p=b(a).height(),n=b(c).width(),e=b(a).width();q.style.position="absolute";q.style.left=t+"px";q.style.top=r+"px";q.style.display="block";b(q).css("opacity",0);var j=a.createElement("div");j.style.position="absolute";j.style.left="0px";j.style.top="0px";j.style.height=(o>p?o:p)+"px";j.style.width=(n>e?n:e)+"px";j.className="DTTT_collection_background";b(j).css("opacity",0);a.body.appendChild(j);a.body.appendChild(q);o=b(q).outerWidth();n=b(q).outerHeight();if(t+o>e){q.style.left=e-o+"px"}if(r+n>p){q.style.top=r-n-b(u).outerHeight()+"px"}this.dom.collection.collection=q;this.dom.collection.background=j;setTimeout(function(){b(q).animate({opacity:1},500);b(j).animate({opacity:0.25},500)},10);b(j).click(function(){s._fnCollectionHide.call(s,null,null)})},_fnCollectionHide:function(e,d){if(!(d!==null&&d.sExtends=="collection")){if(this.dom.collection.collection!==null){b(this.dom.collection.collection).animate({opacity:0},500,function(){this.style.display="none"});b(this.dom.collection.background).animate({opacity:0},500,function(){this.parentNode.removeChild(this)});this.dom.collection.collection=null;this.dom.collection.background=null}}},_fnRowSelectConfig:function(){if(this.s.master){var f=this,e,h,g=this.s.dt.aoOpenRows;b(f.s.dt.nTable).addClass("DTTT_selectable");b("tr",f.s.dt.nTBody).live("click",function(d){if(this.parentNode==f.s.dt.nTBody){e=0;for(h=g.length;e<h;e++){if(this==g[e].nTr){return}}f.s.select.preRowSelect!==null&&!f.s.select.preRowSelect.call(f,d)||(f.s.select.type=="single"?f._fnRowSelectSingle.call(f,this):f._fnRowSelectMulti.call(f,this))}});f.s.dt.aoDrawCallback.push({fn:function(){f.s.select.all&&f.s.dt.oFeatures.bServerSide&&f.fnSelectAll()},sName:"TableTools_select"})}},_fnRowSelectSingle:function(d){if(this.s.master){if(!b("td",d).hasClass(this.s.dt.oClasses.sRowEmpty)){if(b(d).hasClass(this.s.select.selectedClass)){this._fnRowDeselect(d)}else{this.s.select.selected.length!==0&&this._fnRowDeselectAll();this.s.select.selected.push(d);b(d).addClass(this.s.select.selectedClass);this.s.select.postSelected!==null&&this.s.select.postSelected.call(this,d)}TableTools._fnEventDispatch(this,"select",d)}}},_fnRowSelectMulti:function(d){if(this.s.master){if(!b("td",d).hasClass(this.s.dt.oClasses.sRowEmpty)){if(b(d).hasClass(this.s.select.selectedClass)){this._fnRowDeselect(d)}else{this.s.select.selected.push(d);b(d).addClass(this.s.select.selectedClass);this.s.select.postSelected!==null&&this.s.select.postSelected.call(this,d)}TableTools._fnEventDispatch(this,"select",d)}}},_fnRowSelectAll:function(){if(this.s.master){for(var e,d=0,f=this.s.dt.aiDisplayMaster.length;d<f;d++){e=this.s.dt.aoData[this.s.dt.aiDisplayMaster[d]].nTr;if(!b(e).hasClass(this.s.select.selectedClass)){this.s.select.selected.push(e);b(e).addClass(this.s.select.selectedClass)}}this.s.select.all=true;TableTools._fnEventDispatch(this,"select",null)}},_fnRowDeselectAll:function(){if(this.s.master){for(var d=this.s.select.selected.length-1;d>=0;d--){this._fnRowDeselect(d)}this.s.select.all=false;TableTools._fnEventDispatch(this,"select",null)}},_fnRowDeselect:function(e){if(typeof e.nodeName!="undefined"){e=b.inArray(e,this.s.select.selected)}var d=this.s.select.selected[e];b(d).removeClass(this.s.select.selectedClass);this.s.select.selected.splice(e,1);this.s.select.postDeselected!==null&&this.s.select.postDeselected.call(this,d);this.s.select.all=false},_fnTextConfig:function(e,d){var f=this;d.fnInit!==null&&d.fnInit.call(this,e,d);if(d.sToolTip!==""){e.title=d.sToolTip}b(e).hover(function(){b(e).removeClass(d.sButtonClass).addClass(d.sButtonClassHover);d.fnMouseover!==null&&d.fnMouseover.call(this,e,d,null)},function(){b(e).removeClass(d.sButtonClassHover).addClass(d.sButtonClass);d.fnMouseout!==null&&d.fnMouseout.call(this,e,d,null)});d.fnSelect!==null&&TableTools._fnEventListen(this,"select",function(g){d.fnSelect.call(f,e,d,g)});b(e).click(function(g){g.preventDefault();d.fnClick!==null&&d.fnClick.call(f,e,d,null);d.fnComplete!==null&&d.fnComplete.call(f,e,d,null,null);f._fnCollectionHide(e,d)})},_fnFlashConfig:function(f,e){var h=this,g=new ZeroClipboard.Client;e.fnInit!==null&&e.fnInit.call(this,f,e);g.setHandCursor(true);if(e.sAction=="flash_save"){g.setAction("save");g.setCharSet(e.sCharSet=="utf16le"?"UTF16LE":"UTF8");g.setBomInc(e.bBomInc);g.setFileName(e.sFileName.replace("*",this.fnGetTitle(e)))}else{if(e.sAction=="flash_pdf"){g.setAction("pdf");g.setFileName(e.sFileName.replace("*",this.fnGetTitle(e)))}else{g.setAction("copy")}}g.addEventListener("mouseOver",function(){b(f).removeClass(e.sButtonClass).addClass(e.sButtonClassHover);e.fnMouseover!==null&&e.fnMouseover.call(h,f,e,g)});g.addEventListener("mouseOut",function(){b(f).removeClass(e.sButtonClassHover).addClass(e.sButtonClass);e.fnMouseout!==null&&e.fnMouseout.call(h,f,e,g)});g.addEventListener("mouseDown",function(){e.fnClick!==null&&e.fnClick.call(h,f,e,g)});g.addEventListener("complete",function(j,d){e.fnComplete!==null&&e.fnComplete.call(h,f,e,g,d);h._fnCollectionHide(f,e)});this._fnFlashGlue(g,f,e.sToolTip)},_fnFlashGlue:function(g,e,k){var j=this,h=e.getAttribute("id");if(a.getElementById(h)){g.glue(e,k);if(g.domElement.parentNode!=g.div.parentNode&&typeof j.__bZCWarning=="undefined"){j.s.dt.oApi._fnLog(this.s.dt,0,"It looks like you are using the version of ZeroClipboard which came with TableTools 1. Please update to use the version that came with TableTools 2.");j.__bZCWarning=true}}else{setTimeout(function(){j._fnFlashGlue(g,e,k)},100)}},_fnFlashSetText:function(f,e){e=this._fnChunkData(e,8192);f.clearText();for(var h=0,g=e.length;h<g;h++){f.appendText(e[h])}},_fnColumnTargets:function(e){var d=[],f=this.s.dt;if(typeof e=="object"){i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(false)}i=0;for(iLen=e.length;i<iLen;i++){d[e[i]]=true}}else{if(e=="visible"){i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(f.aoColumns[i].bVisible?true:false)}}else{if(e=="hidden"){i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(f.aoColumns[i].bVisible?false:true)}}else{i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(true)}}}}return d},_fnNewline:function(d){return d.sNewLine=="auto"?navigator.userAgent.match(/Windows/)?"\r\n":"\n":d.sNewLine},_fnGetDataTablesData:function(w){var v,u,t,s,q="",r="",p=this.s.dt,j=new RegExp(w.sFieldBoundary,"g"),n=this._fnColumnTargets(w.mColumns),e=this._fnNewline(w);if(w.bHeader){v=0;for(u=p.aoColumns.length;v<u;v++){if(n[v]){r=p.aoColumns[v].sTitle.replace(/\n/g," ").replace(/<.*?>/g,"");r=this._fnHtmlDecode(r);q+=this._fnBoundData(r,w.sFieldBoundary,j)+w.sFieldSeperator}}q=q.slice(0,w.sFieldSeperator.length*-1);q+=e}t=0;for(s=p.aiDisplay.length;t<s;t++){if(!(typeof w.bSelectedOnly&&w.bSelectedOnly&&!b(p.aoData[p.aiDisplay[t]].nTr).hasClass(this.s.select.selectedClass))){v=0;for(u=p.aoColumns.length;v<u;v++){if(n[v]){r=p.aoData[p.aiDisplay[t]]._aData[v];if(typeof r=="string"){r=r.replace(/\n/g," ");r=r.replace(/<img.*?\s+alt\s*=\s*(?:"([^"]+)"|'([^']+)'|([^\s>]+)).*?>/gi,"$1$2$3");r=r.replace(/<.*?>/g,"")}else{r=r+""}r=r.replace(/^\s+/,"").replace(/\s+$/,"");r=this._fnHtmlDecode(r);q+=this._fnBoundData(r,w.sFieldBoundary,j)+w.sFieldSeperator}}q=q.slice(0,w.sFieldSeperator.length*-1);q+=e}}q.slice(0,-1);if(w.bFooter){v=0;for(u=p.aoColumns.length;v<u;v++){if(n[v]&&p.aoColumns[v].nTf!==null){r=p.aoColumns[v].nTf.innerHTML.replace(/\n/g," ").replace(/<.*?>/g,"");r=this._fnHtmlDecode(r);q+=this._fnBoundData(r,w.sFieldBoundary,j)+w.sFieldSeperator}}q=q.slice(0,w.sFieldSeperator.length*-1)}return _sLastData=q},_fnBoundData:function(e,d,f){return d===""?e:d+e.replace(f,"\\"+d)+d},_fnChunkData:function(g,e){for(var k=[],j=g.length,h=0;h<j;h+=e){h+e<j?k.push(g.substring(h,h+e)):k.push(g.substring(h,j))}return k},_fnHtmlDecode:function(g){if(g.indexOf("&")==-1){return g}g=this._fnChunkData(g,2048);var e=a.createElement("div"),m,l,k,j="";m=0;for(l=g.length;m<l;m++){k=g[m].lastIndexOf("&");if(k!=-1&&g[m].length>=8&&k>g[m].length-8){g[m].substr(k);g[m]=g[m].substr(0,k)}e.innerHTML=g[m];j+=e.childNodes[0].nodeValue}return j},_fnPrintConfig:function(e,d){var f=this;d.fnInit!==null&&d.fnInit.call(this,e,d);b(e).hover(function(){b(e).removeClass(d.sButtonClass).addClass(d.sButtonClassHover)},function(){b(e).removeClass(d.sButtonClassHover).addClass(d.sButtonClass)});d.fnSelect!==null&&TableTools._fnEventListen(this,"select",function(g){d.fnSelect.call(f,e,d,g)});b(e).click(function(g){g.preventDefault();f._fnPrintStart.call(f,g,d);d.fnClick!==null&&d.fnClick.call(f,e,d,null);d.fnComplete!==null&&d.fnComplete.call(f,e,d,null,null);f._fnCollectionHide(e,d)})},_fnPrintStart:function(j,e){var o=this;j=this.s.dt;this._fnPrintHideNodes(j.nTable);this.s.print.saveStart=j._iDisplayStart;this.s.print.saveLength=j._iDisplayLength;if(e.bShowAll){j._iDisplayStart=0;j._iDisplayLength=-1;j.oApi._fnCalculateEnd(j);j.oApi._fnDraw(j)}if(j.oScroll.sX!==""||j.oScroll.sY!==""){this._fnPrintScrollStart(j)}j=j.aanFeatures;for(var n in j){if(n!="i"&&n!="t"&&n.length==1){for(var m=0,k=j[n].length;m<k;m++){this.dom.print.hidden.push({node:j[n][m],display:"block"});j[n][m].style.display="none"}}}b(a.body).addClass("DTTT_Print");if(e.sInfo!==""){var l=a.createElement("div");l.className="DTTT_print_info";l.innerHTML=e.sInfo;a.body.appendChild(l);setTimeout(function(){b(l).fadeOut("normal",function(){a.body.removeChild(l)})},2000)}if(e.sMessage!==""){this.dom.print.message=a.createElement("div");this.dom.print.message.className="DTTT_PrintMessage";this.dom.print.message.innerHTML=e.sMessage;a.body.insertBefore(this.dom.print.message,a.body.childNodes[0])}this.s.print.saveScroll=b(c).scrollTop();c.scrollTo(0,0);this.s.print.funcEnd=function(d){o._fnPrintEnd.call(o,d)};b(a).bind("keydown",null,this.s.print.funcEnd)},_fnPrintEnd:function(e){if(e.keyCode==27){e.preventDefault();e=this.s.dt;var d=this.s.print,f=this.dom.print;this._fnPrintShowNodes();if(e.oScroll.sX!==""||e.oScroll.sY!==""){this._fnPrintScrollEnd()}c.scrollTo(0,d.saveScroll);if(f.message!==null){a.body.removeChild(f.message);f.message=null}b(a.body).removeClass("DTTT_Print");e._iDisplayStart=d.saveStart;e._iDisplayLength=d.saveLength;e.oApi._fnCalculateEnd(e);e.oApi._fnDraw(e);b(a).unbind("keydown",this.s.print.funcEnd);this.s.print.funcEnd=null}},_fnPrintScrollStart:function(){var e=this.s.dt;e.nScrollHead.getElementsByTagName("div")[0].getElementsByTagName("table");var d=e.nTable.parentNode,f=e.nTable.getElementsByTagName("thead");f.length>0&&e.nTable.removeChild(f[0]);if(e.nTFoot!==null){f=e.nTable.getElementsByTagName("tfoot");f.length>0&&e.nTable.removeChild(f[0])}f=e.nTHead.cloneNode(true);e.nTable.insertBefore(f,e.nTable.childNodes[0]);if(e.nTFoot!==null){f=e.nTFoot.cloneNode(true);e.nTable.insertBefore(f,e.nTable.childNodes[1])}if(e.oScroll.sX!==""){e.nTable.style.width=b(e.nTable).outerWidth()+"px";d.style.width=b(e.nTable).outerWidth()+"px";d.style.overflow="visible"}if(e.oScroll.sY!==""){d.style.height=b(e.nTable).outerHeight()+"px";d.style.overflow="visible"}},_fnPrintScrollEnd:function(){var e=this.s.dt,d=e.nTable.parentNode;if(e.oScroll.sX!==""){d.style.width=e.oApi._fnStringToCss(e.oScroll.sX);d.style.overflow="auto"}if(e.oScroll.sY!==""){d.style.height=e.oApi._fnStringToCss(e.oScroll.sY);d.style.overflow="auto"}},_fnPrintShowNodes:function(){for(var e=this.dom.print.hidden,d=0,f=e.length;d<f;d++){e[d].node.style.display=e[d].display}e.splice(0,e.length)},_fnPrintHideNodes:function(j){for(var e=this.dom.print.hidden,o=j.parentNode,n=o.childNodes,m=0,k=n.length;m<k;m++){if(n[m]!=j&&n[m].nodeType==1){var l=b(n[m]).css("display");if(l!="none"){e.push({node:n[m],display:l});n[m].style.display="none"}}}o.nodeName!="BODY"&&this._fnPrintHideNodes(o)}};TableTools._aInstances=[];TableTools._aListeners=[];TableTools.fnGetMasters=function(){for(var e=[],d=0,f=TableTools._aInstances.length;d<f;d++){TableTools._aInstances[d].s.master&&e.push(TableTools._aInstances[d].s)}return e};TableTools.fnGetInstance=function(e){if(typeof e!="object"){e=a.getElementById(e)}for(var d=0,f=TableTools._aInstances.length;d<f;d++){if(TableTools._aInstances[d].s.master&&TableTools._aInstances[d].dom.table==e){return TableTools._aInstances[d]}}return null};TableTools._fnEventListen=function(e,d,f){TableTools._aListeners.push({that:e,type:d,fn:f})};TableTools._fnEventDispatch=function(g,e,m){for(var l=TableTools._aListeners,k=0,j=l.length;k<j;k++){g.dom.table==l[k].that.dom.table&&l[k].type==e&&l[k].fn(m)}};TableTools.BUTTONS={csv:{sAction:"flash_save",sCharSet:"utf8",bBomInc:false,sFileName:"*.csv",sFieldBoundary:"'",sFieldSeperator:",",sNewLine:"auto",sTitle:"",sToolTip:"",sButtonClass:"DTTT_button_csv",sButtonClassHover:"DTTT_button_csv_hover",sButtonText:"CSV",mColumns:"all",bHeader:true,bFooter:true,bSelectedOnly:false,fnMouseover:null,fnMouseout:null,fnClick:function(e,d,f){this.fnSetText(f,this.fnGetTableData(d))},fnSelect:null,fnComplete:null,fnInit:null},xls:{sAction:"flash_save",sCharSet:"utf16le",bBomInc:true,sFileName:"*.csv",sFieldBoundary:"",sFieldSeperator:"\t",sNewLine:"auto",sTitle:"",sToolTip:"",sButtonClass:"DTTT_button_xls",sButtonClassHover:"DTTT_button_xls_hover",sButtonText:"Excel",mColumns:"all",bHeader:true,bFooter:true,bSelectedOnly:false,fnMouseover:null,fnMouseout:null,fnClick:function(e,d,f){this.fnSetText(f,this.fnGetTableData(d))},fnSelect:null,fnComplete:null,fnInit:null},copy:{sAction:"flash_copy",sFieldBoundary:"",sFieldSeperator:"\t",sNewLine:"auto",sToolTip:"",sButtonClass:"DTTT_button_copy",sButtonClassHover:"DTTT_button_copy_hover",sButtonText:"Copy",mColumns:"all",bHeader:true,bFooter:true,bSelectedOnly:false,fnMouseover:null,fnMouseout:null,fnClick:function(e,d,f){this.fnSetText(f,this.fnGetTableData(d))},fnSelect:null,fnComplete:function(f,e,h,g){f=g.split("\n").length;f=this.s.dt.nTFoot===null?f-1:f-2;alert("Copied "+f+" row"+(f==1?"":"s")+" to the clipboard")},fnInit:null},pdf:{sAction:"flash_pdf",sFieldBoundary:"",sFieldSeperator:"\t",sNewLine:"\n",sFileName:"*.pdf",sToolTip:"",sTitle:"",sButtonClass:"DTTT_button_pdf",sButtonClassHover:"DTTT_button_pdf_hover",sButtonText:"PDF",mColumns:"all",bHeader:true,bFooter:false,bSelectedOnly:false,fnMouseover:null,fnMouseout:null,sPdfOrientation:"portrait",sPdfSize:"A4",sPdfMessage:"",fnClick:function(e,d,f){this.fnSetText(f,"title:"+this.fnGetTitle(d)+"\nmessage:"+d.sPdfMessage+"\ncolWidth:"+this.fnCalcColRatios(d)+"\norientation:"+d.sPdfOrientation+"\nsize:"+d.sPdfSize+"\n--/TableToolsOpts--\n"+this.fnGetTableData(d))},fnSelect:null,fnComplete:null,fnInit:null},print:{sAction:"print",sInfo:"<h6>Print view</h6><p>Please use your browser's print function to print this table. Press escape when finished.",sMessage:"",bShowAll:true,sToolTip:"View print view",sButtonClass:"DTTT_button_print",sButtonClassHover:"DTTT_button_print_hover",sButtonText:"Print",fnMouseover:null,fnMouseout:null,fnClick:null,fnSelect:null,fnComplete:null,fnInit:null},text:{sAction:"text",sToolTip:"",sButtonClass:"DTTT_button_text",sButtonClassHover:"DTTT_button_text_hover",sButtonText:"Text button",mColumns:"all",bHeader:true,bFooter:true,bSelectedOnly:false,fnMouseover:null,fnMouseout:null,fnClick:null,fnSelect:null,fnComplete:null,fnInit:null},select:{sAction:"text",sToolTip:"",sButtonClass:"DTTT_button_text",sButtonClassHover:"DTTT_button_text_hover",sButtonText:"Select button",mColumns:"all",bHeader:true,bFooter:true,fnMouseover:null,fnMouseout:null,fnClick:null,fnSelect:function(d){this.fnGetSelected().length!==0?b(d).removeClass("DTTT_disabled"):b(d).addClass("DTTT_disabled")},fnComplete:null,fnInit:function(d){b(d).addClass("DTTT_disabled")}},select_single:{sAction:"text",sToolTip:"",sButtonClass:"DTTT_button_text",sButtonClassHover:"DTTT_button_text_hover",sButtonText:"Select button",mColumns:"all",bHeader:true,bFooter:true,fnMouseover:null,fnMouseout:null,fnClick:null,fnSelect:function(d){this.fnGetSelected().length==1?b(d).removeClass("DTTT_disabled"):b(d).addClass("DTTT_disabled")},fnComplete:null,fnInit:function(d){b(d).addClass("DTTT_disabled")}},select_all:{sAction:"text",sToolTip:"",sButtonClass:"DTTT_button_text",sButtonClassHover:"DTTT_button_text_hover",sButtonText:"Select all",mColumns:"all",bHeader:true,bFooter:true,fnMouseover:null,fnMouseout:null,fnClick:function(){this.fnSelectAll()},fnSelect:function(d){this.fnGetSelected().length==this.s.dt.fnRecordsDisplay()?b(d).addClass("DTTT_disabled"):b(d).removeClass("DTTT_disabled")},fnComplete:null,fnInit:null},select_none:{sAction:"text",sToolTip:"",sButtonClass:"DTTT_button_text",sButtonClassHover:"DTTT_button_text_hover",sButtonText:"Deselect all",mColumns:"all",bHeader:true,bFooter:true,fnMouseover:null,fnMouseout:null,fnClick:function(){this.fnSelectNone()},fnSelect:function(d){this.fnGetSelected().length!==0?b(d).removeClass("DTTT_disabled"):b(d).addClass("DTTT_disabled")},fnComplete:null,fnInit:function(d){b(d).addClass("DTTT_disabled")}},ajax:{sAction:"text",sFieldBoundary:"",sFieldSeperator:"\t",sNewLine:"\n",sAjaxUrl:"/xhr.php",sToolTip:"",sButtonClass:"DTTT_button_text",sButtonClassHover:"DTTT_button_text_hover",sButtonText:"Ajax button",mColumns:"all",bHeader:true,bFooter:true,bSelectedOnly:false,fnMouseover:null,fnMouseout:null,fnClick:function(e,d){e=this.fnGetTableData(d);b.ajax({url:d.sAjaxUrl,data:[{name:"tableData",value:e}],success:d.fnAjaxComplete,dataType:"json",type:"POST",cache:false,error:function(){alert("Error detected when sending table data to server")}})},fnSelect:null,fnComplete:null,fnInit:null,fnAjaxComplete:function(){alert("Ajax complete")}},collection:{sAction:"collection",sToolTip:"",sButtonClass:"DTTT_button_collection",sButtonClassHover:"DTTT_button_collection_hover",sButtonText:"Collection",fnMouseover:null,fnMouseout:null,fnClick:function(e,d){this._fnCollectionShow(e,d)},fnSelect:null,fnComplete:null,fnInit:null}};TableTools.DEFAULTS={sSwfPath:"media/swf/copy_cvs_xls_pdf.swf",sRowSelect:"none",sSelectedClass:"DTTT_selected",fnPreRowSelect:null,fnRowSelected:null,fnRowDeselected:null,aButtons:["copy","csv","xls","pdf","print"]};TableTools.prototype.CLASS="TableTools";TableTools.VERSION="2.0.1";TableTools.prototype.VERSION=TableTools.VERSION;typeof b.fn.dataTable=="function"&&typeof b.fn.dataTableExt.fnVersionCheck=="function"&&b.fn.dataTableExt.fnVersionCheck("1.7.0")?b.fn.dataTableExt.aoFeatures.push({fnInit:function(d){d=new TableTools(d.oInstance,typeof d.oInit.oTableTools!="undefined"?d.oInit.oTableTools:{});TableTools._aInstances.push(d);return d.dom.container},cFeature:"T",sFeature:"TableTools"}):alert("Warning: TableTools 2 requires DataTables 1.7 or greater - www.datatables.net/download")})(jQuery,window,document);